<?xml version="1.0" encoding="UTF-8"?><jatools Class="jatools.ReportDocument" Name="jatools report template"><VariableContext/><Page><Name>panel</Name><Children ItemClass="PagePanel"><Item0><Name>header</Name><Width>912</Width><Height>77</Height><Children ItemClass="Label"><Item0><Text>学生流动人数明细表</Text><ForeColor>-16776961</ForeColor><Font><Face>楷体_GB2312</Face><Style>1</Style><Size>22</Size></Font><HorizontalAlignment>1</HorizontalAlignment><X>326</X><Y>13</Y><Width>260</Width><Height>41</Height></Item0></Children><Type>100</Type><InitPrint>_grade=new String[]{"小学","初中","高中"};
nj=new String[]{"一年级","二年级","三年级","四年级","五年级","六年级"};
old_num=0;
add_num=0;
del_num=0;

</InitPrint></Item0><Item1><Name>body</Name><Y>77</Y><Width>912</Width><Height>624</Height><Children ItemClass="PowerTable"><Item0><PrintStyle>align-x:50%;</PrintStyle><X>16</X><Y>11</Y><Children><Item0 Class="HeaderTable"><NodePath>banji</NodePath><Children ItemClass="RowPanel"><Item0><Cell><Row>3</Row><Col>0</Col><RowSpan>3</RowSpan><ColSpan>2</ColSpan></Cell><Children><Item0 Class="RowPanel"><Cell><Row>3</Row><Col>0</Col><ColSpan>2</ColSpan></Cell><Children ItemClass="Text"><Item0><Variable>=nj[$nianji]</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>1</Col></Cell></Item0></Children><NodePath>nianji</NodePath></Item0><Item1 Class="Text"><Variable>=_grade[$grade]</Variable><Border/><HorizontalAlignment>1</HorizontalAlignment><PrintStyle>united-level:1;</PrintStyle><Cell><Row>3</Row><Col>0</Col><RowSpan>3</RowSpan></Cell><BeforePrint>grade_index=$grade;</BeforePrint></Item1><Item2 Class="RowPanel"><Cell><Row>4</Row><Col>0</Col><ColSpan>2</ColSpan></Cell><Children ItemClass="Label"><Item0><Text>合计</Text><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>1</Col></Cell></Item0></Children></Item2><Item3 Class="RowPanel"><Cell><Row>5</Row><Col>0</Col><ColSpan>2</ColSpan></Cell><Children ItemClass="Label"><Item0><Text>其中女生</Text><BackColor>-2692865</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>1</Col></Cell></Item0></Children></Item3></Children><NodePath>grade</NodePath></Item0></Children><Cell><Row>3</Row><Col>0</Col><RowSpan>3</RowSpan><ColSpan>2</ColSpan></Cell></Item0><Item1 Class="HeaderTable"><NodePath>banji</NodePath><Children><Item0 Class="Label"><Text>原来人数</Text><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>2</Col><RowSpan>3</RowSpan></Cell></Item0><Item1 Class="ColumnPanel"><NodePath>move</NodePath><Children><Item0 Class="Label"><Text>在校人数</Text><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>9</Col><RowSpan>3</RowSpan></Cell></Item0><Item1 Class="ColumnPanel"><NodePath>zj</NodePath><Children ItemClass="ColumnPanel"><Item0><NodePath>mt</NodePath><Children ItemClass="ColumnPanel"><Item0><NodePath>move_type</NodePath><PrintStyle>visible:${return $mt==0;};</PrintStyle><Children><Item0 Class="Label"><Text>转入</Text><Border/><HorizontalAlignment>1</HorizontalAlignment><PrintStyle>united-level:1;</PrintStyle><Cell><Row>1</Row><Col>4</Col></Cell></Item0><Item1 Class="Text"><Variable>=mc[$move_type]</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>2</Row><Col>4</Col></Cell></Item1></Children><Cell><Row>0</Row><Col>4</Col><RowSpan>3</RowSpan></Cell></Item0><Item1><NodePath>move_type</NodePath><PrintStyle>visible:${return $mt==1;};</PrintStyle><Children ItemClass="Text"><Item0><Variable>=mc[$move_type]</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>1</Row><Col>5</Col><RowSpan>2</RowSpan></Cell></Item0></Children><Cell><Row>0</Row><Col>5</Col><RowSpan>3</RowSpan></Cell></Item1></Children><Cell><Row>0</Row><Col>4</Col><RowSpan>3</RowSpan><ColSpan>2</ColSpan></Cell></Item0><Item1><PrintStyle>visible:${return $zj==0;};</PrintStyle><Children ItemClass="Label"><Item0><Text>合计</Text><BackColor>-8339201</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>1</Row><Col>3</Col><RowSpan>2</RowSpan></Cell></Item0><Item1><Text>学生增加人数</Text><Border/><HorizontalAlignment>1</HorizontalAlignment><PrintStyle>united-level:1;</PrintStyle><Cell><Row>0</Row><Col>3</Col><ColSpan>3</ColSpan></Cell></Item1></Children><Cell><Row>0</Row><Col>3</Col><RowSpan>3</RowSpan></Cell></Item1></Children><Cell><Row>0</Row><Col>3</Col><RowSpan>3</RowSpan><ColSpan>3</ColSpan></Cell></Item1><Item2 Class="ColumnPanel"><NodePath>zj</NodePath><Children ItemClass="ColumnPanel"><Item0><NodePath>mt</NodePath><Children ItemClass="ColumnPanel"><Item0><NodePath>move_type</NodePath><PrintStyle>visible:${return $mt==2;};</PrintStyle><Children><Item0 Class="Text"><Variable>=mc[$move_type]</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>2</Row><Col>7</Col></Cell></Item0><Item1 Class="Label"><Text>转出</Text><Border/><HorizontalAlignment>1</HorizontalAlignment><PrintStyle>united-level:1;</PrintStyle><Cell><Row>1</Row><Col>7</Col></Cell></Item1></Children><Cell><Row>0</Row><Col>7</Col><RowSpan>3</RowSpan></Cell></Item0><Item1><NodePath>move_type</NodePath><PrintStyle>visible:${return $mt==3;};</PrintStyle><Children ItemClass="Text"><Item0><Variable>=mc[$move_type]</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>1</Row><Col>8</Col><RowSpan>2</RowSpan></Cell></Item0></Children><Cell><Row>0</Row><Col>8</Col><RowSpan>3</RowSpan></Cell></Item1></Children><Cell><Row>0</Row><Col>7</Col><RowSpan>3</RowSpan><ColSpan>2</ColSpan></Cell></Item0><Item1><PrintStyle>visible:${return $zj==1;};</PrintStyle><Children ItemClass="Label"><Item0><Text>学生减少人数</Text><Border/><HorizontalAlignment>1</HorizontalAlignment><PrintStyle>united-level:1;</PrintStyle><Cell><Row>0</Row><Col>6</Col><ColSpan>3</ColSpan></Cell></Item0><Item1><Text>合计</Text><BackColor>-8339201</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>1</Row><Col>6</Col><RowSpan>2</RowSpan></Cell></Item1></Children><Cell><Row>0</Row><Col>6</Col><RowSpan>3</RowSpan></Cell></Item1></Children><Cell><Row>0</Row><Col>6</Col><RowSpan>3</RowSpan><ColSpan>3</ColSpan></Cell></Item2></Children><Cell><Row>0</Row><Col>3</Col><RowSpan>3</RowSpan><ColSpan>7</ColSpan></Cell></Item1></Children><RightFlow>true</RightFlow><Cell><Row>0</Row><Col>2</Col><RowSpan>3</RowSpan><ColSpan>8</ColSpan></Cell></Item1><Item2 Class="Label"><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>0</Col><RowSpan>3</RowSpan><ColSpan>2</ColSpan></Cell></Item2><Item3 Class="Text"><Variable>=old_num=brs.renshu.DEF2.sum();</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>2</Col></Cell></Item3><Item4 Class="Text"><Variable>=old_num=brs.renshu.DEF2.sum()</Variable><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>2</Col></Cell></Item4><Item5 Class="Text"><Variable>=rs.name.DEF2.count()</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>4</Col></Cell></Item5><Item6 Class="Text"><Variable>=old_num+add_num-del_num</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>9</Col></Cell></Item6><Item7 Class="Text"><Variable>=rs.name.DEF2.count()</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>5</Col></Cell></Item7><Item8 Class="Text"><Variable>=rs.name.DEF2.count()</Variable><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>4</Col></Cell></Item8><Item9 Class="Text"><Variable>=rs.name.DEF2.count()</Variable><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>5</Col></Cell></Item9><Item10 Class="Text"><Variable>=rs.name.DEF2.count()</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>7</Col></Cell></Item10><Item11 Class="Text"><Variable>=rs.name.DEF2.count()</Variable><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>7</Col></Cell></Item11><Item12 Class="Text"><Variable>=rs.name.DEF2.count()</Variable><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>8</Col></Cell></Item12><Item13 Class="Text"><Variable>=rs.name.DEF2.count()</Variable><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>8</Col></Cell></Item13><Item14 Class="Text"><Variable>=
if(rs.name ==null){
   add_num =0;
   return 0;
}
else
{
add_num=rs.name.DEF2.count();
return add_num;
}</Variable><BackColor>-8339201</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>3</Col></Cell></Item14><Item15 Class="Text"><Variable>=del_num=tmp=rs.name.DEF2.count();
if(rs.name.DEF2.count() ==null){
    del_num = 0;
return 0;
}

return tmp;</Variable><BackColor>-8339201</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>6</Col></Cell></Item15><Item16 Class="Text"><Variable>=return old_num+add_num-del_num</Variable><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>9</Col></Cell></Item16><Item17 Class="Text"><Variable>=return add_num=rs.name.DEF2.count()
</Variable><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>3</Col></Cell></Item17><Item18 Class="Text"><Variable>=(rs.name==null) ? null : (del_num=rs.name.DEF2.count())</Variable><BackColor>-8339201</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>4</Row><Col>6</Col></Cell></Item18><Item19 Class="Text"><Variable>=old_num=brs.girl.DEF2.sum()</Variable><BackColor>-2692865</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>2</Col></Cell></Item19><Item20 Class="Text"><Variable>=return old_num+add_num-del_num</Variable><BackColor>-2692865</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>9</Col></Cell></Item20><Item21 Class="Text"><Variable>=return add_num=girls.name{$grade}{0,0}.count()</Variable><BackColor>-2692865</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>3</Col></Cell></Item21><Item22 Class="Text"><Variable>=girls.name{$grade}{0,0,0,$move_type}.count()</Variable><BackColor>-2692865</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>4</Col></Cell></Item22><Item23 Class="Text"><Variable>=girls.name{$grade}{0,0,1,$move_type}.count()</Variable><BackColor>-2692865</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>5</Col></Cell></Item23><Item24 Class="Text"><Variable>=return del_num=girls.name{$grade}{0,1}.count()</Variable><BackColor>-16384</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>6</Col></Cell></Item24><Item25 Class="Text"><Variable>=girls.name{$grade}{0,1,2,$move_type}.count()</Variable><BackColor>-2692865</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>7</Col></Cell></Item25><Item26 Class="Text"><Variable>=girls.name{$grade}{0,1,3,$move_type}.count()</Variable><BackColor>-2692865</BackColor><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>5</Row><Col>8</Col></Cell></Item26></Children><ColumnWidths>39,45,46,47,30,27,42,30,30,51</ColumnWidths><RowHeights>20,44,44,20,20,20</RowHeights></Item0></Children><Type>102</Type></Item1></Children><PageFormat><Width>952</Width><Height>741</Height></PageFormat></Page><NodeSource><Children ItemClass="DatasetNodeSource"><Item0><Children><Item0 Class="GroupNodeSource"><Children ItemClass="GroupNodeSource"><Item0><Group><Field>nianji</Field></Group></Item0></Children><Group><Field>grade</Field></Group></Item0><Item1 Class="CrossIndexNodeSource"><IndexFields Len="2">grade,nianji</IndexFields><IndexFields2 Len="1">renshu</IndexFields2><TagName>brs</TagName></Item1><Item2 Class="DatasetNodeSource"><Children><Item0 Class="CrossIndexNodeSource"><IndexFields Len="2">grade,nianji</IndexFields><IndexFields2 Len="3">zj,mt,move_type</IndexFields2><TagName>rs</TagName></Item0><Item1 Class="CrossIndexNodeSource"><IndexFields Len="1">grade</IndexFields><IndexFields2 Len="4">sex,zj,mt,move_type</IndexFields2><TagName>girls</TagName></Item1><Item2 Class="GroupNodeSource"><Children ItemClass="GroupNodeSource"><Item0><Children ItemClass="GroupNodeSource"><Item0><Group><Field>move_type</Field></Group></Item0></Children><Group><Field>mt</Field></Group></Item0></Children><Group><Field>zj</Field></Group></Item2></Children><Reader Class="CsvReader"><Name>move</Name><FilePath>sampledata\edu\byrs\xsld.txt</FilePath><LocalFile>true</LocalFile><UserDefinedColumns ItemClass="FormulaIntervalColumn"><Item0><Name>mt</Name><Formulas ItemClass="IntervalFormula"><Item0><Expression>move_type&lt;3</Expression><As>0</As></Item0><Item1><Expression>move_type&gt;=3&amp;&amp;move_type&lt;7</Expression><As>1</As></Item1><Item2><Expression>move_type&gt;=7&amp;&amp;move_type&lt;10</Expression><As>2</As></Item2><Item3><Expression>move_type&gt;=10&amp;&amp;move_type&lt;20</Expression><As>3</As></Item3></Formulas></Item0><Item1><Name>zj</Name><Formulas ItemClass="IntervalFormula"><Item0><Expression>mt&lt;2</Expression><As>0</As></Item0><Item1><Expression>mt&gt;=2</Expression><As>1</As></Item1></Formulas></Item1></UserDefinedColumns></Reader><TagName>move</TagName></Item2><Item3 Class="ArrayNodeSource"><TagName>mc</TagName><Expression>String[] mc=new String[]{"外省","外区","区内","复学","留级","失返","其他","外省","外区","区内","休学","送工读" ,"开除 ","留级", "死亡","拘留", "前招" ,"文体调选","退学","流失"}</Expression></Item3></Children><Reader Class="CsvReader"><Name>banji</Name><FilePath>sampledata\edu\byrs\bjxx.txt</FilePath><LocalFile>true</LocalFile></Reader><TagName>banji</TagName></Item0></Children></NodeSource></jatools>