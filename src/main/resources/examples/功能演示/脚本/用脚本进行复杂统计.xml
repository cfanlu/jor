<?xml version="1.0" encoding="UTF-8"?><jatools Class="jatools.ReportDocument" Name="jatools report template"><VariableContext/><Page><Name>panel</Name><Children ItemClass="PagePanel"><Item0><Name>body</Name><Width>750</Width><Height>1082</Height><Children><Item0 Class="Label"><Text>采用事件脚本进行计算,可以提高运行效率,降低设计报表的难度</Text><ForeColor>-65536</ForeColor><X>75</X><Y>6</Y><Width>464</Width><Height>32</Height></Item0><Item1 Class="Table"><NodePath>订单查询</NodePath><X>20</X><Y>80</Y><Children><Item0 Class="RowPanel"><Cell><Row>1</Row><Col>0</Col><ColSpan>7</ColSpan></Cell><Children ItemClass="Text"><Item0><Variable>=$.年份</Variable><Border/><Cell><Row>1</Row><Col>0</Col></Cell></Item0><Item1><Variable>=$.月份</Variable><Border/><Cell><Row>1</Row><Col>1</Col></Cell></Item1><Item2><Variable>=$.产品</Variable><Border/><Cell><Row>1</Row><Col>2</Col></Cell></Item2><Item3><Variable>=$.地区</Variable><Border/><Cell><Row>1</Row><Col>3</Col></Cell></Item3><Item4><Variable>=$.城市</Variable><Border/><Cell><Row>1</Row><Col>4</Col></Cell></Item4><Item5><Variable>=$.客户</Variable><Border/><Cell><Row>1</Row><Col>5</Col></Cell></Item5><Item6><Variable>=$.金额</Variable><Border/><HorizontalAlignment>2</HorizontalAlignment><Cell><Row>1</Row><Col>6</Col></Cell><InitPrint>totalcount = 0;
  topcount=0;
  华北最大额=0;
  北京订单数=0;
</InitPrint><BeforePrint>//总笔数累加
  totalcount ++ ;
// 计算大额订单数
  if($.金额&gt;=1000)
  {
  topcount++;
  }
//计算华北最大订单金额
  if($.地区=="华北" &amp;&amp; 华北最大额&lt;$.金额)
  华北最大额=$.金额;
  //计算北京订单数
  if($.城市=="北京")
北京订单数++;
</BeforePrint></Item6></Children><NodePath>Row</NodePath></Item0><Item1 Class="Label"><Text>总计</Text><Cell><Row>2</Row><Col>0</Col><ColSpan>0</ColSpan></Cell></Item1><Item2 Class="Label"><Text>年份</Text><BackColor>-4144897</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><Cell><Row>0</Row><Col>0</Col></Cell></Item2><Item3 Class="Label"><Text>月份</Text><BackColor>-4144897</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><Cell><Row>0</Row><Col>1</Col></Cell></Item3><Item4 Class="Label"><Text>产品</Text><BackColor>-4144897</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><Cell><Row>0</Row><Col>2</Col></Cell></Item4><Item5 Class="Label"><Text>地区</Text><BackColor>-4144897</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><Cell><Row>0</Row><Col>3</Col></Cell></Item5><Item6 Class="Label"><Text>城市</Text><BackColor>-4144897</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><Cell><Row>0</Row><Col>4</Col></Cell></Item6><Item7 Class="Label"><Text>客户</Text><BackColor>-4144897</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><Cell><Row>0</Row><Col>5</Col></Cell></Item7><Item8 Class="Label"><Text>金额</Text><BackColor>-4144897</BackColor><Border><StyleText>border-top:1 solid #000000;border-left:1 solid #000000;border-right:1 solid #000000;</StyleText></Border><Cell><Row>0</Row><Col>6</Col></Cell></Item8><Item9 Class="Label"><Text>北京订单数:</Text><HorizontalAlignment>2</HorizontalAlignment><Cell><Row>6</Row><Col>2</Col><ColSpan>2</ColSpan></Cell></Item9><Item10 Class="Label"><Text>华北地区最大订单金额:</Text><HorizontalAlignment>2</HorizontalAlignment><Cell><Row>5</Row><Col>2</Col><ColSpan>2</ColSpan></Cell></Item10><Item11 Class="Label"><Text>其中,</Text><Cell><Row>4</Row><Col>1</Col></Cell></Item11><Item12 Class="Label"><Text>大额订单数(1000以上)笔数:</Text><HorizontalAlignment>2</HorizontalAlignment><Cell><Row>4</Row><Col>2</Col><ColSpan>2</ColSpan></Cell></Item12><Item13 Class="Label"><Text>总笔数:</Text><Cell><Row>3</Row><Col>0</Col></Cell></Item13><Item14 Class="Text"><Variable>=totalcount</Variable><ForeColor>-16776961</ForeColor><Border><StyleText>border-bottom:1 solid #000000;</StyleText></Border><Cell><Row>3</Row><Col>1</Col></Cell></Item14><Item15 Class="Text"><Variable>=topcount;
</Variable><ForeColor>-16776961</ForeColor><Cell><Row>4</Row><Col>4</Col></Cell></Item15><Item16 Class="Text"><Variable>=华北最大额</Variable><ForeColor>-16776961</ForeColor><Cell><Row>5</Row><Col>4</Col></Cell></Item16><Item17 Class="Text"><Variable>=北京订单数</Variable><ForeColor>-16776961</ForeColor><Border><StyleText>border-bottom:1 solid #000000;</StyleText></Border><Cell><Row>6</Row><Col>4</Col></Cell></Item17><Item18 Class="Text"><Variable>=topcount</Variable><ForeColor>-16776961</ForeColor><Cell><Row>2</Row><Col>5</Col></Cell></Item18></Children><ColumnWidths>80,80,80,80,80,80,80</ColumnWidths><RowHeights>20,20,20,20,20,20,20</RowHeights></Item1></Children><Type>102</Type></Item0></Children><PageFormat><Width>790</Width><Height>1122</Height></PageFormat></Page><NodeSource><Children ItemClass="DatasetNodeSource"><Item0><Children ItemClass="RowNodeSource"><Item0/></Children><Reader Class="SqlReader"><Name>订单查询</Name><Sql>select * from 订单查询 where 年份&lt;&gt;1995</Sql><Description>select * from 订单查询 where 年份&lt;&gt;1995</Description><Connection><Driver>org.hsqldb.jdbcDriver</Driver><User>sa</User><Url>jdbc:hsqldb:./demosdb/mydb</Url></Connection></Reader><TagName>订单查询</TagName></Item0></Children></NodeSource></jatools>